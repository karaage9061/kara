<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPI言語クイズ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #ffffff;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
            width: 100%;
            max-width: 200px;
        }

        .button:hover {
            background: #0056b3;
        }

        .button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .choice-btn {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
            text-align: left;
            width: 100%;
            font-size: 16px;
        }

        .choice-btn:hover {
            background: #e9ecef;
        }

        .choice-btn.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .choice-btn.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .choice-btn.disabled {
            pointer-events: none;
        }

        .progress {
            background: #e9ecef;
            height: 10px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .progress-bar {
            background: #007bff;
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s;
        }

        .result {
            text-align: center;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
        }

        .result.correct {
            background: #d4edda;
            color: #155724;
        }

        .result.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .explanation {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
        }

        .hidden {
            display: none;
        }

        .score {
            text-align: center;
            font-size: 2em;
            margin: 20px 0;
        }

        .count-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .card {
                padding: 15px;
            }
            
            .button {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ホーム画面 -->
        <div id="home" class="card">
            <h1>📚 SPI言語クイズ</h1>
            <p style="text-align: center; margin-bottom: 30px;">熟語・語句対策（50問収録）</p>
            
            <div style="text-align: center;">
                <h3>問題数を選択してください</h3>
                <div class="count-selector">
                    <button class="button" onclick="setCount(10)">10問</button>
                    <button class="button" onclick="setCount(20)">20問</button>
                    <button class="button" onclick="setCount(30)">30問</button>
                    <button class="button" onclick="setCount(50)">全問</button>
                </div>
                
                <div style="margin: 20px 0;">
                    <input type="number" id="customCount" min="1" max="50" placeholder="カスタム問題数" style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-right: 10px;">
                    <button class="button" onclick="setCustomCount()" style="max-width: 100px;">設定</button>
                </div>
                
                <button id="startBtn" class="button" onclick="startQuiz()" disabled style="background: #28a745; max-width: 300px; margin-top: 20px;">
                    クイズを開始する
                </button>
            </div>
        </div>

        <!-- クイズ画面 -->
        <div id="quiz" class="card hidden">
            <div class="progress">
                <div id="progressBar" class="progress-bar" style="width: 0%"></div>
            </div>
            
            <div id="questionNumber" style="text-align: center; margin-bottom: 20px; font-size: 18px;"></div>
            
            <div id="questionText" style="font-size: 20px; margin-bottom: 30px; font-weight: bold;"></div>
            
            <div id="choices"></div>
            
            <div id="result" class="result hidden"></div>
            
            <div id="explanation" class="explanation hidden"></div>
            
            <button id="nextBtn" class="button hidden" onclick="nextQuestion()">次の問題へ</button>
        </div>

        <!-- 結果画面 -->
        <div id="resultScreen" class="card hidden">
            <h1>🎉 クイズ完了！</h1>
            
            <div class="score">
                <div id="finalScore"></div>
                <div id="percentage" style="font-size: 0.7em; color: #666;"></div>
            </div>
            
            <div style="text-align: center;">
                <button class="button" onclick="goHome()" style="background: #28a745;">ホームに戻る</button>
                <button id="retryBtn" class="button hidden" onclick="retryWrong()" style="background: #ffc107; color: #000;">間違えた問題を復習</button>
            </div>
        </div>
    </div>

    <script>
        // 問題データ
        const questions = [
            {
                q: "自由勝手にはねまわること",
                choices: ["飛翔", "跳躍", "躍動", "跳梁", "躍如"],
                answer: 3,
                explanation: "跳梁: 悪者などが勢いよく、のさばり回ること"
            },
            {
                q: "自分の信ずるところを遠慮せずにいうこと",
                choices: ["直言", "進言", "忠言", "放言", "断言"],
                answer: 0,
                explanation: "直言: 思うところを遠慮なく、率直に言うこと"
            },
            {
                q: "きわだって他より優れていること",
                choices: ["隔絶", "出色", "優越", "破格", "筆頭"],
                answer: 1,
                explanation: "出色: 他よりも際立って優れていること"
            },
            {
                q: "衰えたり栄えたりすること",
                choices: ["消長", "進退", "断続", "変遷", "流転"],
                answer: 0,
                explanation: "消長: 勢いが衰えたり盛んになったりすること"
            },
            {
                q: "以前からの願い",
                choices: ["切願", "宿願", "懇願", "悲願", "念願"],
                answer: 1,
                explanation: "宿願: 以前から抱いている願い"
            },
            {
                q: "他人を威嚇するような態度",
                choices: ["横柄", "尊大", "居丈高", "鉄仮面", "威風堂々"],
                answer: 2,
                explanation: "居丈高: 威圧的で高圧的な態度"
            },
            {
                q: "思わず笑うこと",
                choices: ["苦笑", "哄笑", "一笑", "失笑", "嘲笑"],
                answer: 3,
                explanation: "失笑: 思わず吹き出して笑うこと"
            },
            {
                q: "物がゆらゆらゆれる",
                choices: ["なびく", "ぶれる", "ふるえる", "たゆたう", "はためく"],
                answer: 3,
                explanation: "たゆたう: ゆらゆらと漂うこと"
            },
            {
                q: "経験を積んで人柄などが円熟すること",
                choices: ["老練", "晩成", "成熟", "老成", "大成"],
                answer: 3,
                explanation: "老成: 経験を積んで人格が円熟すること"
            },
            {
                q: "何もしないで傍観している",
                choices: ["腰をすえる", "口をぬぐう", "目をつぶる", "足をとめる", "手をこまねく"],
                answer: 4,
                explanation: "手をこまねく: 何もしないで傍観すること"
            },
            {
                q: "直接は言葉に表さないところ",
                choices: ["本心", "無言", "他意", "余念", "言外"],
                answer: 4,
                explanation: "言外: 言葉には直接表れていない意味"
            },
            {
                q: "やり方などを受け継ぎ、したがうこと",
                choices: ["因習", "慣例", "伝承", "踏襲", "伝統"],
                answer: 3,
                explanation: "踏襲: 前例に従うこと"
            },
            {
                q: "どうにもならないことを残念がる",
                choices: ["気に病む", "ほぞをかむ", "胸を痛める", "腕をこまねく", "こうべをたれる"],
                answer: 1,
                explanation: "ほぞをかむ: 後悔すること"
            },
            {
                q: "心がきたなく、いやしい",
                choices: ["がめつい", "さもしい", "あくどい", "はしたない", "意地きたない"],
                answer: 1,
                explanation: "さもしい: 心がきたなく、いやしい"
            },
            {
                q: "不行き届きでけしからぬこと",
                choices: ["不倫", "不義", "不埒", "不実", "不徳"],
                answer: 2,
                explanation: "不埒: 道理に外れていること"
            },
            {
                q: "当を得たことば",
                choices: ["金言", "巧言", "至言", "名言", "格言"],
                answer: 2,
                explanation: "至言: 当を得た言葉"
            },
            {
                q: "言葉を加えたり言いかえたりして分かりやすく説明すること",
                choices: ["啓発", "喧伝", "示唆", "指南", "敷衍"],
                answer: 4,
                explanation: "敷衍: 詳しく説明すること"
            },
            {
                q: "並外れて程度を超えること",
                choices: ["希代", "莫大", "絶大", "奇抜", "法外"],
                answer: 4,
                explanation: "法外: 常識を超えていること"
            },
            {
                q: "しかたがないと思って受ける",
                choices: ["たえる", "あまんずる", "へりくだる", "もてあます", "ひらきなおる"],
                answer: 1,
                explanation: "あまんずる: 仕方なく受け入れること"
            },
            {
                q: "物事が進行しておもしろくなったところ",
                choices: ["頂点", "佳境", "要所", "醍醐味", "正念場"],
                answer: 1,
                explanation: "佳境: 最も面白い場面"
            },
            {
                q: "問題とされながらまだ解決がつかない事柄",
                choices: ["保留", "懸案", "未決", "難問", "棚上げ"],
                answer: 1,
                explanation: "懸案: 未解決の問題"
            },
            {
                q: "心をいためなやますこと",
                choices: ["腐心", "疑心", "逆心", "虚心", "執心"],
                answer: 0,
                explanation: "腐心: 心を悩ますこと"
            },
            {
                q: "ためらわずに思い切ってするさま",
                choices: ["果断", "愚直", "短慮", "無謀", "勇敢"],
                answer: 0,
                explanation: "果断: 思い切りがよいこと"
            },
            {
                q: "ねらいを定めること",
                choices: ["目星", "目標", "標的", "見当", "照準"],
                answer: 4,
                explanation: "照準: 狙いを定めること"
            },
            {
                q: "おしはかること、思いやること",
                choices: ["推考", "類推", "推論", "推察", "推定"],
                answer: 3,
                explanation: "推察: 推し量ること"
            },
            {
                q: "巧みでないこと",
                choices: ["つたない", "ぎこちない", "たわいない", "ふがいない", "おぼつかない"],
                answer: 0,
                explanation: "つたない: 巧みでないこと"
            },
            {
                q: "他の意見に反対して論じ返すこと",
                choices: ["口論", "反発", "反駁", "論争", "論破"],
                answer: 2,
                explanation: "反駁: 反論すること"
            },
            {
                q: "そのことだけにかかわって、他をおろそかにする",
                choices: ["ひたる", "かまける", "いそしむ", "かかりきる", "なおざりにする"],
                answer: 1,
                explanation: "かまける: 熱中して他を怠ること"
            },
            {
                q: "他人の権利を傷つけたり、社会秩序を乱したりする",
                choices: ["威圧する", "愚弄する", "蹂躙する", "席巻する", "籠絡する"],
                answer: 2,
                explanation: "蹂躙: 踏みにじること"
            },
            {
                q: "境遇に満足しているさまを言動に表すこと",
                choices: ["至福", "闊達", "満喫", "謳歌", "有頂天"],
                answer: 3,
                explanation: "謳歌: 声高らかに歌うように表現すること"
            },
            {
                q: "何もせずぶらぶらしていること",
                choices: ["安穏", "怠惰", "無精", "無為", "悠長"],
                answer: 3,
                explanation: "無為: 何もしないこと"
            },
            {
                q: "立派に見せようとしてうわべを飾ること",
                choices: ["装飾", "粉飾", "彩飾", "見栄", "上塗り"],
                answer: 1,
                explanation: "粉飾: 表面を美しく飾ること"
            },
            {
                q: "好ましくないとして拒み退けること",
                choices: ["意気", "邪険", "敬遠", "疎外", "排斥"],
                answer: 4,
                explanation: "排斥: 押しのけて退けること"
            },
            {
                q: "一時しのぎにとりつくろっておくこと",
                choices: ["虚勢", "見栄", "糊塗", "虚飾", "上塗り"],
                answer: 2,
                explanation: "糊塗: 一時的にごまかすこと"
            },
            {
                q: "個人の判断で処理すること",
                choices: ["専横", "私見", "裁量", "独断", "英断"],
                answer: 2,
                explanation: "裁量: 自分の判断で処理すること"
            },
            {
                q: "あわてずゆっくりと事を始めるさま",
                choices: ["ようやく", "おいおいに", "おっとりと", "おもむろに", "じっくりと"],
                answer: 3,
                explanation: "おもむろに: ゆっくりと動作を始めるさま"
            },
            {
                q: "なりふりかまわず懸命に事にあたっている様子",
                choices: ["けなげ", "ひたむき", "やみくも", "おおわらわ", "てんてこまい"],
                answer: 3,
                explanation: "おおわらわ: 大騒ぎをするさま"
            },
            {
                q: "あいまいな所がないように細かく気を配って丁念なこと",
                choices: ["克明", "周到", "精巧", "繊細", "緻密"],
                answer: 0,
                explanation: "克明: 詳しく明らかなこと"
            },
            {
                q: "人を威圧するような態度",
                choices: ["横柄", "尊大", "居丈高", "鉄面皮", "威風堂々"],
                answer: 2,
                explanation: "居丈高: 威圧的で高圧的な態度"
            },
            {
                q: "殊勝な心がけの持ち主だ",
                choices: ["健気な", "可憐な", "優雅な", "利口な", "堅実な"],
                answer: 0,
                explanation: "健気: けなげな、立派な心がけの"
            },
            {
                q: "わがままで好き勝手に振る舞うこと",
                choices: ["厚顔", "傲慢", "専横", "独断", "不遜"],
                answer: 2,
                explanation: "専横: わがまま勝手に振る舞うこと"
            },
            {
                q: "細かく丹念な記録",
                choices: ["克明な", "周到な", "精密な", "繊細な", "肝要な"],
                answer: 0,
                explanation: "克明: 詳しく明らかなこと"
            },
            {
                q: "つつみかくさないさま",
                choices: ["露呈", "暴露", "あけすけ", "あか抜け", "つつ抜け"],
                answer: 2,
                explanation: "あけすけ: 包み隠さず、率直なさま"
            },
            {
                q: "ある学問・技術について広く深い知識と理解を持っていること",
                choices: ["英知", "奥義", "造詣", "含蓄", "高尚"],
                answer: 2,
                explanation: "造詣: 学問・技芸に深く通じていること"
            },
            {
                q: "そうするよりほかにない",
                choices: ["申し分ない", "ほかならない", "さしさわりない", "よんどころない", "抜き差しならない"],
                answer: 3,
                explanation: "よんどころない: やむを得ない、仕方がない"
            },
            {
                q: "仲が悪くにらみ合うこと",
                choices: ["敵視", "敵対", "反抗", "反目", "背反"],
                answer: 3,
                explanation: "反目: 仲が悪くにらみ合うこと"
            },
            {
                q: "だんだんいい気になって人を見下したふるまいをすること",
                choices: ["虚勢", "誇示", "自負", "増長", "不遜"],
                answer: 3,
                explanation: "増長: だんだん調子に乗って思い上がること"
            },
            {
                q: "ものごとの扱い方がぞんざいなこと",
                choices: ["横着", "粗略", "粗漏", "無謀", "乱暴"],
                answer: 1,
                explanation: "粗略: 扱いがぞんざいなこと"
            },
            {
                q: "厳しく区別すること",
                choices: ["鑑別", "差別", "識別", "峻別", "判別"],
                answer: 3,
                explanation: "峻別: 厳しく区別すること"
            },
            {
                q: "勝つ見込みが大きい",
                choices: ["清算", "目算", "公算", "概算", "試算"],
                answer: 2,
                explanation: "公算: 見込み、可能性"
            }
        ];

        // グローバル変数
        let selectedCount = 0;
        let currentQuestions = [];
        let currentIndex = 0;
        let correctCount = 0;
        let wrongQuestions = [];

        // 問題数設定
        function setCount(count) {
            selectedCount = count;
            updateStartButton();
        }

        function setCustomCount() {
            const input = document.getElementById('customCount');
            const count = parseInt(input.value);
            if (count >= 1 && count <= 50) {
                selectedCount = count;
                updateStartButton();
            } else {
                alert('1から50の間で入力してください');
            }
        }

        function updateStartButton() {
            const btn = document.getElementById('startBtn');
            if (selectedCount > 0) {
                btn.disabled = false;
                btn.textContent = selectedCount + '問でスタート';
            } else {
                btn.disabled = true;
                btn.textContent = 'クイズを開始する';
            }
        }

        // クイズ開始
        function startQuiz() {
            if (selectedCount === 0) return;

            // 問題をシャッフルして選択
            const shuffled = questions.sort(() => Math.random() - 0.5);
            currentQuestions = shuffled.slice(0, selectedCount);
            
            currentIndex = 0;
            correctCount = 0;
            wrongQuestions = [];

            // 画面切り替え
            document.getElementById('home').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            document.getElementById('resultScreen').classList.add('hidden');

            showQuestion();
        }

        // 問題表示
        function showQuestion() {
            const question = currentQuestions[currentIndex];
            
            // プログレスバー更新
            const progress = (currentIndex / currentQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // 問題番号
            document.getElementById('questionNumber').textContent = 
                `問題 ${currentIndex + 1} / ${currentQuestions.length}`;
            
            // 問題文
            document.getElementById('questionText').textContent = question.q;
            
            // 選択肢
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';
            
            question.choices.forEach((choice, index) => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.textContent = String.fromCharCode(65 + index) + '. ' + choice;
                btn.onclick = () => selectChoice(index);
                choicesDiv.appendChild(btn);
            });
            
            // 結果・解説を隠す
            document.getElementById('result').classList.add('hidden');
            document.getElementById('explanation').classList.add('hidden');
            document.getElementById('nextBtn').classList.add('hidden');
        }

        // 回答選択
        function selectChoice(selected) {
            const question = currentQuestions[currentIndex];
            const choices = document.querySelectorAll('.choice-btn');
            
            // すべてのボタンを無効化
            choices.forEach(btn => {
                btn.classList.add('disabled');
                btn.onclick = null;
            });
            
            // 正解をハイライト
            choices[question.answer].classList.add('correct');
            
            // 結果表示
            const resultDiv = document.getElementById('result');
            if (selected === question.answer) {
                correctCount++;
                resultDiv.textContent = '✅ 正解！';
                resultDiv.className = 'result correct';
            } else {
                choices[selected].classList.add('incorrect');
                resultDiv.textContent = '❌ 不正解';
                resultDiv.className = 'result incorrect';
                wrongQuestions.push(question);
            }
            resultDiv.classList.remove('hidden');
            
            // 解説表示
            const explanationDiv = document.getElementById('explanation');
            explanationDiv.innerHTML = '<strong>解説:</strong> ' + question.explanation;
            explanationDiv.classList.remove('hidden');
            
            // 次へボタン表示
            const nextBtn = document.getElementById('nextBtn');
            if (currentIndex < currentQuestions.length - 1) {
                nextBtn.textContent = '次の問題へ';
            } else {
                nextBtn.textContent = '結果を見る';
            }
            nextBtn.classList.remove('hidden');
        }

        // 次の問題へ
        function nextQuestion() {
            currentIndex++;
            if (currentIndex < currentQuestions.length) {
                showQuestion();
            } else {
                showResult();
            }
        }

        // 結果表示
        function showResult() {
            const percentage = Math.round((correctCount / currentQuestions.length) * 100);
            
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            document.getElementById('finalScore').textContent = 
                correctCount + ' / ' + currentQuestions.length + ' 正解';
            document.getElementById('percentage').textContent = '正解率: ' + percentage + '%';
            
            // 復習ボタン
            const retryBtn = document.getElementById('retryBtn');
            if (wrongQuestions.length > 0) {
                retryBtn.classList.remove('hidden');
                retryBtn.textContent = '間違えた問題を復習 (' + wrongQuestions.length + '問)';
            } else {
                retryBtn.classList.add('hidden');
            }
        }

        // ホームに戻る
        function goHome() {
            document.getElementById('home').classList.remove('hidden');
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            
            selectedCount = 0;
            document.getElementById('customCount').value = '';
            updateStartButton();
        }

        // 間違えた問題を復習
        function retryWrong() {
            if (wrongQuestions.length === 0) return;
            
            currentQuestions = [...wrongQuestions];
            selectedCount = wrongQuestions.length;
            currentIndex = 0;
            correctCount = 0;
            wrongQuestions = [];
            
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            
            showQuestion();
        }
    </script>
</body>
</html>
