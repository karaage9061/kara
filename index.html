<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPIè¨€èªã‚¯ã‚¤ã‚º - ç†Ÿèªãƒ»èªå¥å¯¾ç­–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .quiz-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2rem;
        }

        .home-screen {
            text-align: center;
        }

        .subtitle {
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .question-count-selector {
            margin: 30px 0;
        }

        .count-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .count-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .count-btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }

        .custom-input {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        .custom-input input {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            width: 80px;
            text-align: center;
        }

        .start-btn {
            background: #48bb78;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .quiz-screen {
            display: none;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: #4299e1;
            height: 100%;
            transition: width 0.3s ease;
        }

        .question-counter {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .question-text {
            font-size: 1.3rem;
            margin-bottom: 30px;
            line-height: 1.6;
            color: #2d3748;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-btn {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 15px 20px;
            border-radius: 12px;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
        }

        .choice-btn:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        .choice-btn.correct {
            background: #c6f6d5;
            border-color: #68d391;
            color: #22543d;
        }

        .choice-btn.incorrect {
            background: #fed7d7;
            border-color: #fc8181;
            color: #742a2a;
        }

        .choice-btn.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .result-display {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .result-display.correct {
            background: #c6f6d5;
            color: #22543d;
        }

        .result-display.incorrect {
            background: #fed7d7;
            color: #742a2a;
        }

        .explanation {
            background: #f0f8ff;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            border-left: 4px solid #4299e1;
        }

        .explanation h3 {
            color: #2b6cb0;
            margin-bottom: 10px;
        }

        .next-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1rem;
        }

        .result-screen {
            display: none;
            text-align: center;
        }

        .score-display {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e9ecef;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .score-number {
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .action-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }

        .action-btn.retry {
            background: #ed8936;
        }

        .action-btn.home {
            background: #48bb78;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .quiz-card {
                padding: 20px;
                border-radius: 15px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .count-options {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ›ãƒ¼ãƒ ç”»é¢ -->
        <div id="home-screen" class="quiz-card home-screen">
            <h1>ğŸ“š SPIè¨€èªã‚¯ã‚¤ã‚º</h1>
            <p class="subtitle">ç†Ÿèªãƒ»èªå¥å¯¾ç­–ï¼ˆå…¨286å•åéŒ²ï¼‰</p>
            
            <div class="question-count-selector">
                <h3>å•é¡Œæ•°ã‚’é¸æŠã—ã¦ãã ã•ã„</h3>
                <div class="count-options">
                    <button class="count-btn" onclick="selectCount(10)">10å•</button>
                    <button class="count-btn" onclick="selectCount(20)">20å•</button>
                    <button class="count-btn" onclick="selectCount(30)">30å•</button>
                    <button class="count-btn" onclick="selectCount(50)">50å•</button>
                </div>
                
                <div class="custom-input">
                    <span>ã‚«ã‚¹ã‚¿ãƒ :</span>
                    <input type="number" id="custom-count" min="1" max="286" placeholder="å•é¡Œæ•°">
                    <button class="count-btn" onclick="selectCustomCount()">è¨­å®š</button>
                </div>
            </div>
            
            <button id="start-btn" class="start-btn" onclick="startQuiz()" disabled>
                ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹
            </button>
        </div>

        <!-- ã‚¯ã‚¤ã‚ºç”»é¢ -->
        <div id="quiz-screen" class="quiz-card quiz-screen">
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill" style="width: 0%"></div>
            </div>
            
            <div id="question-counter" class="question-counter"></div>
            
            <div id="question-text" class="question-text"></div>
            
            <div id="choices" class="choices"></div>
            
            <div id="result-display" class="result-display hidden"></div>
            
            <div id="explanation" class="explanation hidden"></div>
            
            <button id="next-btn" class="next-btn hidden" onclick="nextQuestion()">
                æ¬¡ã®å•é¡Œã¸
            </button>
        </div>

        <!-- çµæœç”»é¢ -->
        <div id="result-screen" class="quiz-card result-screen">
            <h1>ğŸ‰ ã‚¯ã‚¤ã‚ºå®Œäº†ï¼</h1>
            
            <div class="score-display">
                <div>æ­£è§£æ•°</div>
                <div id="score-number" class="score-number"></div>
                <div id="score-percentage"></div>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn home" onclick="goHome()">
                    ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
                </button>
                <button id="retry-btn" class="action-btn retry" onclick="retryIncorrect()">
                    é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’
                </button>
            </div>
        </div>
    </div>

    <script>
        // å•é¡Œãƒ‡ãƒ¼ã‚¿
        const quizData = [
            {
                question: "è‡ªç”±å‹æ‰‹ã«ã¯ã­ã¾ã‚ã‚‹ã“ã¨",
                choices: ["é£›ç¿”", "è·³èº", "èºå‹•", "è·³æ¢", "èºå¦‚"],
                correct: 3,
                explanation: "è·³æ¢: æ‚ªè€…ãªã©ãŒå‹¢ã„ã‚ˆãã€ã®ã•ã°ã‚Šå›ã‚‹ã“ã¨"
            },
            {
                question: "è‡ªåˆ†ã®ä¿¡ãšã‚‹ã¨ã“ã‚ã‚’é æ…®ã›ãšã«ã„ã†ã“ã¨",
                choices: ["ç›´è¨€", "é€²è¨€", "å¿ è¨€", "æ”¾è¨€", "æ–­è¨€"],
                correct: 0,
                explanation: "ç›´è¨€: æ€ã†ã¨ã“ã‚ã‚’é æ…®ãªãã€ç‡ç›´ã«è¨€ã†ã“ã¨"
            },
            {
                question: "ãã‚ã ã£ã¦ä»–ã‚ˆã‚Šå„ªã‚Œã¦ã„ã‚‹ã“ã¨",
                choices: ["éš”çµ¶", "å‡ºè‰²", "å„ªè¶Š", "ç ´æ ¼", "ç­†é ­"],
                correct: 1,
                explanation: "å‡ºè‰²: ä»–ã‚ˆã‚Šã‚‚éš›ç«‹ã£ã¦å„ªã‚Œã¦ã„ã‚‹ã“ã¨"
            },
            {
                question: "è¡°ãˆãŸã‚Šæ „ãˆãŸã‚Šã™ã‚‹ã“ã¨",
                choices: ["æ¶ˆé•·", "é€²é€€", "æ–­ç¶š", "å¤‰é·", "æµè»¢"],
                correct: 0,
                explanation: "æ¶ˆé•·: å‹¢ã„ãŒè¡°ãˆãŸã‚Šç››ã‚“ã«ãªã£ãŸã‚Šã™ã‚‹ã“ã¨"
            },
            {
                question: "ä»¥å‰ã‹ã‚‰ã®é¡˜ã„",
                choices: ["åˆ‡é¡˜", "å®¿é¡˜", "æ‡‡é¡˜", "æ‚²é¡˜", "å¿µé¡˜"],
                correct: 1,
                explanation: "å®¿é¡˜: ä»¥å‰ã‹ã‚‰æŠ±ã„ã¦ã„ã‚‹é¡˜ã„"
            },
            {
                question: "å‘è¿‘ã®æ„å‘³ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯",
                choices: ["èº«è¿‘ãª", "å‘ã—ã„", "ä½ä¿—ãª", "ä½ç´šãª", "å½“ä»Šã®"],
                correct: 0,
                explanation: "å‘è¿‘: èº«è¿‘ã§å¹³å‡¡ãªã“ã¨"
            },
            {
                question: "ä»–äººã‚’å¨åš‡ã™ã‚‹ã‚ˆã†ãªæ…‹åº¦",
                choices: ["æ¨ªæŸ„", "å°Šå¤§", "å±…ä¸ˆé«˜", "é‰„ä»®é¢", "å¨é¢¨å ‚ã€…"],
                correct: 2,
                explanation: "å±…ä¸ˆé«˜: å¨åœ§çš„ã§é«˜åœ§çš„ãªæ…‹åº¦"
            },
            {
                question: "æ€ã‚ãšç¬‘ã†ã“ã¨",
                choices: ["è‹¦ç¬‘", "å“„ç¬‘", "ä¸€ç¬‘", "å¤±ç¬‘", "å˜²ç¬‘"],
                correct: 3,
                explanation: "å¤±ç¬‘: æ€ã‚ãšå¹ãå‡ºã—ã¦ç¬‘ã†ã“ã¨"
            },
            {
                question: "ç‰©ãŒã‚†ã‚‰ã‚†ã‚‰ã‚†ã‚Œã‚‹",
                choices: ["ãªã³ã", "ã¶ã‚Œã‚‹", "ãµã‚‹ãˆã‚‹", "ãŸã‚†ãŸã†", "ã¯ãŸã‚ã"],
                correct: 3,
                explanation: "ãŸã‚†ãŸã†: ã‚†ã‚‰ã‚†ã‚‰ã¨æ¼‚ã†ã“ã¨"
            },
            {
                question: "çµŒé¨“ã‚’ç©ã‚“ã§äººæŸ„ãªã©ãŒå††ç†Ÿã™ã‚‹ã“ã¨",
                choices: ["è€ç·´", "æ™©æˆ", "æˆç†Ÿ", "è€æˆ", "å¤§æˆ"],
                correct: 3,
                explanation: "è€æˆ: çµŒé¨“ã‚’ç©ã‚“ã§äººæ ¼ãŒå††ç†Ÿã™ã‚‹ã“ã¨"
            },
            {
                question: "äºŒã¤ã®äº‹æŸ„ãŒã´ã£ãŸã‚Šã¨ä¸€è‡´ã™ã‚‹ã“ã¨",
                choices: ["ç¬¦å·", "åˆåŒ", "é©åˆ", "åˆä¸€", "ç…§åˆ"],
                correct: 0,
                explanation: "ç¬¦å·: äºŒã¤ã®äº‹æŸ„ãŒã´ã£ãŸã‚Šã¨ä¸€è‡´ã™ã‚‹ã“ã¨"
            },
            {
                question: "ã‚‚ã®ã”ã¨ã®è©³ã—ã„äº‹æƒ…",
                choices: ["å­ç´°", "æ˜ç´°", "ç²¾ç´°", "ç´°éƒ¨", "ç´°äº‹"],
                correct: 0,
                explanation: "å­ç´°: ã‚‚ã®ã”ã¨ã®è©³ã—ã„äº‹æƒ…"
            },
            {
                question: "ä½•ã‚‚ã—ãªã„ã§å‚è¦³ã—ã¦ã„ã‚‹",
                choices: ["è…°ã‚’ã™ãˆã‚‹", "å£ã‚’ã¬ãã†", "ç›®ã‚’ã¤ã¶ã‚‹", "è¶³ã‚’ã¨ã‚ã‚‹", "æ‰‹ã‚’ã“ã¾ã­ã"],
                correct: 4,
                explanation: "æ‰‹ã‚’ã“ã¾ã­ã: ä½•ã‚‚ã—ãªã„ã§å‚è¦³ã™ã‚‹ã“ã¨"
            },
            {
                question: "ç›´æ¥ã¯è¨€è‘‰ã«è¡¨ã•ãªã„ã¨ã“ã‚",
                choices: ["æœ¬å¿ƒ", "ç„¡è¨€", "ä»–æ„", "ä½™å¿µ", "è¨€å¤–"],
                correct: 4,
                explanation: "è¨€å¤–: è¨€è‘‰ã«ã¯ç›´æ¥è¡¨ã‚Œã¦ã„ãªã„æ„å‘³"
            },
            {
                question: "ã‚„ã‚Šæ–¹ãªã©ã‚’å—ã‘ç¶™ãã€ã—ãŸãŒã†ã“ã¨",
                choices: ["å› ç¿’", "æ…£ä¾‹", "ä¼æ‰¿", "è¸è¥²", "ä¼çµ±"],
                correct: 3,
                explanation: "è¸è¥²: å‰ä¾‹ã«å¾“ã†ã“ã¨"
            },
            {
                question: "ã©ã†ã«ã‚‚ãªã‚‰ãªã„ã“ã¨ã‚’æ®‹å¿µãŒã‚‹",
                choices: ["æ°—ã«ç—…ã‚€", "ã»ãã‚’ã‹ã‚€", "èƒ¸ã‚’ç—›ã‚ã‚‹", "è…•ã‚’ã“ã¾ã­ã", "ã“ã†ã¹ã‚’ãŸã‚Œã‚‹"],
                correct: 1,
                explanation: "ã»ãã‚’ã‹ã‚€: å¾Œæ‚”ã™ã‚‹ã“ã¨"
            },
            {
                question: "å¿ƒãŒããŸãªãã€ã„ã‚„ã—ã„",
                choices: ["ãŒã‚ã¤ã„", "ã•ã‚‚ã—ã„", "ã‚ãã©ã„", "ã¯ã—ãŸãªã„", "æ„åœ°ããŸãªã„"],
                correct: 1,
                explanation: "ã•ã‚‚ã—ã„: å¿ƒãŒããŸãªãã€ã„ã‚„ã—ã„"
            },
            {
                question: "ä¸è¡Œãå±Šãã§ã‘ã—ã‹ã‚‰ã¬ã“ã¨",
                choices: ["ä¸å€«", "ä¸ç¾©", "ä¸åŸ’", "ä¸å®Ÿ", "ä¸å¾³"],
                correct: 2,
                explanation: "ä¸åŸ’: é“ç†ã«å¤–ã‚Œã¦ã„ã‚‹ã“ã¨"
            },
            {
                question: "å½“ã‚’å¾—ãŸã“ã¨ã°",
                choices: ["é‡‘è¨€", "å·§è¨€", "è‡³è¨€", "åè¨€", "æ ¼è¨€"],
                correct: 2,
                explanation: "è‡³è¨€: å½“ã‚’å¾—ãŸè¨€è‘‰"
            },
            {
                question: "è¨€è‘‰ã‚’åŠ ãˆãŸã‚Šè¨€ã„ã‹ãˆãŸã‚Šã—ã¦åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã™ã‚‹ã“ã¨",
                choices: ["å•“ç™º", "å–§ä¼", "ç¤ºå”†", "æŒ‡å—", "æ•·è¡"],
                correct: 4,
                explanation: "æ•·è¡: è©³ã—ãèª¬æ˜ã™ã‚‹ã“ã¨"
            },
            {
                question: "ä¸¦å¤–ã‚Œã¦ç¨‹åº¦ã‚’è¶…ãˆã‚‹ã“ã¨",
                choices: ["å¸Œä»£", "è«å¤§", "çµ¶å¤§", "å¥‡æŠœ", "æ³•å¤–"],
                correct: 4,
                explanation: "æ³•å¤–: å¸¸è­˜ã‚’è¶…ãˆã¦ã„ã‚‹ã“ã¨"
            },
            {
                question: "ã—ã‹ãŸãŒãªã„ã¨æ€ã£ã¦å—ã‘ã‚‹",
                choices: ["ãŸãˆã‚‹", "ã‚ã¾ã‚“ãšã‚‹", "ã¸ã‚Šãã ã‚‹", "ã‚‚ã¦ã‚ã¾ã™", "ã²ã‚‰ããªãŠã‚‹"],
                correct: 1,
                explanation: "ã‚ã¾ã‚“ãšã‚‹: ä»•æ–¹ãªãå—ã‘å…¥ã‚Œã‚‹ã“ã¨"
            },
            {
                question: "ç‰©äº‹ãŒé€²è¡Œã—ã¦ãŠã‚‚ã—ã‚ããªã£ãŸã¨ã“ã‚",
                choices: ["é ‚ç‚¹", "ä½³å¢ƒ", "è¦æ‰€", "é†é†å‘³", "æ­£å¿µå ´"],
                correct: 1,
                explanation: "ä½³å¢ƒ: æœ€ã‚‚é¢ç™½ã„å ´é¢"
            },
            {
                question: "å•é¡Œã¨ã•ã‚ŒãªãŒã‚‰ã¾ã è§£æ±ºãŒã¤ã‹ãªã„äº‹æŸ„",
                choices: ["ä¿ç•™", "æ‡¸æ¡ˆ", "æœªæ±º", "é›£å•", "æ£šä¸Šã’"],
                correct: 1,
                explanation: "æ‡¸æ¡ˆ: æœªè§£æ±ºã®å•é¡Œ"
            },
            {
                question: "è©­å¼ã®æ„å‘³ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯",
                choices: ["ãŠã©ã—", "ã“ã˜ã¤ã‘", "ã„ã„ã‚ã‘", "ã¾ã‘ãŠã—ã¿", "ã„ã„ã®ãŒã‚Œ"],
                correct: 1,
                explanation: "è©­å¼: ä¸€è¦‹æ­£ã—ãã†ã«è¦‹ãˆã‚‹å½ã‚Šã®è«–ç†"
            },
            {
                question: "å¿ƒã‚’ã„ãŸã‚ãªã‚„ã¾ã™ã“ã¨",
                choices: ["è…å¿ƒ", "ç–‘å¿ƒ", "é€†å¿ƒ", "è™šå¿ƒ", "åŸ·å¿ƒ"],
                correct: 0,
                explanation: "è…å¿ƒ: å¿ƒã‚’æ‚©ã¾ã™ã“ã¨"
            },
            {
                question: "ãŸã‚ã‚‰ã‚ãšã«æ€ã„åˆ‡ã£ã¦ã™ã‚‹ã•ã¾",
                choices: ["æœæ–­", "æ„šç›´", "çŸ­æ…®", "ç„¡è¬€", "å‹‡æ•¢"],
                correct: 0,
                explanation: "æœæ–­: æ€ã„åˆ‡ã‚ŠãŒã‚ˆã„ã“ã¨"
            },
            {
                question: "ã­ã‚‰ã„ã‚’å®šã‚ã‚‹ã“ã¨",
                choices: ["ç›®æ˜Ÿ", "ç›®æ¨™", "æ¨™çš„", "è¦‹å½“", "ç…§æº–"],
                correct: 4,
                explanation: "ç…§æº–: ç‹™ã„ã‚’å®šã‚ã‚‹ã“ã¨"
            },
            {
                question: "ãŠã—ã¯ã‹ã‚‹ã“ã¨ã€æ€ã„ã‚„ã‚‹ã“ã¨",
                choices: ["æ¨è€ƒ", "é¡æ¨", "æ¨è«–", "æ¨å¯Ÿ", "æ¨å®š"],
                correct: 3,
                explanation: "æ¨å¯Ÿ: æ¨ã—é‡ã‚‹ã“ã¨"
            },
            {
                question: "å·§ã¿ã§ãªã„ã“ã¨",
                choices: ["ã¤ãŸãªã„", "ãã“ã¡ãªã„", "ãŸã‚ã„ãªã„", "ãµãŒã„ãªã„", "ãŠã¼ã¤ã‹ãªã„"],
                correct: 0,
                explanation: "ã¤ãŸãªã„: å·§ã¿ã§ãªã„ã“ã¨"
            },
            {
                question: "ä»–ã®æ„è¦‹ã«åå¯¾ã—ã¦è«–ã˜è¿”ã™ã“ã¨",
                choices: ["å£è«–", "åç™º", "åé§", "è«–äº‰", "è«–ç ´"],
                correct: 2,
                explanation: "åé§: åè«–ã™ã‚‹ã“ã¨"
            },
            {
                question: "ãã®ã“ã¨ã ã‘ã«ã‹ã‹ã‚ã£ã¦ã€ä»–ã‚’ãŠã‚ãã‹ã«ã™ã‚‹",
                choices: ["ã²ãŸã‚‹", "ã‹ã¾ã‘ã‚‹", "ã„ãã—ã‚€", "ã‹ã‹ã‚Šãã‚‹", "ãªãŠã–ã‚Šã«ã™ã‚‹"],
                correct: 1,
                explanation: "ã‹ã¾ã‘ã‚‹: ç†±ä¸­ã—ã¦ä»–ã‚’æ€ ã‚‹ã“ã¨"
            },
            {
                question: "ä»–äººã®æ¨©åˆ©ã‚’å‚·ã¤ã‘ãŸã‚Šã€ç¤¾ä¼šç§©åºã‚’ä¹±ã—ãŸã‚Šã™ã‚‹",
                choices: ["å¨åœ§ã™ã‚‹", "æ„šå¼„ã™ã‚‹", "è¹‚èº™ã™ã‚‹", "å¸­å·»ã™ã‚‹", "ç± çµ¡ã™ã‚‹"],
                correct: 2,
                explanation: "è¹‚èº™: è¸ã¿ã«ã˜ã‚‹ã“ã¨"
            },
            {
                question: "å¢ƒé‡ã«æº€è¶³ã—ã¦ã„ã‚‹ã•ã¾ã‚’è¨€å‹•ã«è¡¨ã™ã“ã¨",
                choices: ["è‡³ç¦", "é—Šé”", "æº€å–«", "è¬³æ­Œ", "æœ‰é ‚å¤©"],
                correct: 3,
                explanation: "è¬³æ­Œ: å£°é«˜ã‚‰ã‹ã«æ­Œã†ã‚ˆã†ã«è¡¨ç¾ã™ã‚‹ã“ã¨"
            },
            {
                question: "ä½•ã‚‚ã›ãšã¶ã‚‰ã¶ã‚‰ã—ã¦ã„ã‚‹ã“ã¨",
                choices: ["å®‰ç©", "æ€ æƒ°", "ç„¡ç²¾", "ç„¡ç‚º", "æ‚ é•·"],
                correct: 3,
                explanation: "ç„¡ç‚º: ä½•ã‚‚ã—ãªã„ã“ã¨"
            },
            {
                question: "ç«‹æ´¾ã«è¦‹ã›ã‚ˆã†ã¨ã—ã¦ã†ã‚ã¹ã‚’é£¾ã‚‹ã“ã¨",
                choices: ["è£…é£¾", "ç²‰é£¾", "å½©é£¾", "è¦‹æ „", "ä¸Šå¡—ã‚Š"],
                correct: 1,
                explanation: "ç²‰é£¾: è¡¨é¢ã‚’ç¾ã—ãé£¾ã‚‹ã“ã¨"
            },
            {
                question: "å¥½ã¾ã—ããªã„ã¨ã—ã¦æ‹’ã¿é€€ã‘ã‚‹ã“ã¨",
                choices: ["æ„æ°—", "é‚ªé™º", "æ•¬é ", "ç–å¤–", "æ’æ–¥"],
                correct: 4,
                explanation: "æ’æ–¥: æŠ¼ã—ã®ã‘ã¦é€€ã‘ã‚‹ã“ã¨"
            },
            {
                question: "ä¸€æ™‚ã—ã®ãã«ã¨ã‚Šã¤ãã‚ã£ã¦ãŠãã“ã¨",
                choices: ["è™šå‹¢", "è¦‹æ „", "ç³Šå¡—", "è™šé£¾", "ä¸Šå¡—ã‚Š"],
                correct: 2,
                explanation: "ç³Šå¡—: ä¸€æ™‚çš„ã«ã”ã¾ã‹ã™ã“ã¨"
            },
            {
                question: "å€‹äººã®åˆ¤æ–­ã§å‡¦ç†ã™ã‚‹ã“ã¨",
                choices: ["å°‚æ¨ª", "ç§è¦‹", "è£é‡", "ç‹¬æ–­", "è‹±æ–­"],
                correct: 2,
                explanation: "è£é‡: è‡ªåˆ†ã®åˆ¤æ–­ã§å‡¦ç†ã™ã‚‹ã“ã¨"
            },
            {
                question: "ã‚ã‚ã¦ãšã‚†ã£ãã‚Šã¨äº‹ã‚’å§‹ã‚ã‚‹ã•ã¾",
                choices: ["ã‚ˆã†ã‚„ã", "ãŠã„ãŠã„ã«", "ãŠã£ã¨ã‚Šã¨", "ãŠã‚‚ã‚€ã‚ã«", "ã˜ã£ãã‚Šã¨"],
                correct: 3,
                explanation: "ãŠã‚‚ã‚€ã‚ã«: ã‚†ã£ãã‚Šã¨å‹•ä½œã‚’å§‹ã‚ã‚‹ã•ã¾"
            },
            {
                question: "ãªã‚Šãµã‚Šã‹ã¾ã‚ãšæ‡¸å‘½ã«äº‹ã«ã‚ãŸã£ã¦ã„ã‚‹æ§˜å­",
                choices: ["ã‘ãªã’", "ã²ãŸã‚€ã", "ã‚„ã¿ãã‚‚", "ãŠãŠã‚ã‚‰ã‚", "ã¦ã‚“ã¦ã“ã¾ã„"],
                correct: 3,
                explanation: "ãŠãŠã‚ã‚‰ã‚: å¤§é¨’ãã‚’ã™ã‚‹ã•ã¾"
            },
            {
                question: "ã‚ã„ã¾ã„ãªæ‰€ãŒãªã„ã‚ˆã†ã«ç´°ã‹ãæ°—ã‚’é…ã£ã¦ä¸å¿µãªã“ã¨",
                choices: ["å…‹æ˜", "å‘¨åˆ°", "ç²¾å·§", "ç¹Šç´°", "ç·»å¯†"],
                correct: 0,
                explanation: "å…‹æ˜: è©³ã—ãæ˜ã‚‰ã‹ãªã“ã¨"
            },
            {
                question: "äººã‚’å¨åœ§ã™ã‚‹ã‚ˆã†ãªæ…‹åº¦",
                choices: ["æ¨ªæŸ„", "å°Šå¤§", "å±…ä¸ˆé«˜", "é‰„é¢çš®", "å¨é¢¨å ‚ã€…"],
                correct: 2,
                explanation: "å±…ä¸ˆé«˜: å¨åœ§çš„ã§é«˜åœ§çš„ãªæ…‹åº¦"
            },
            {
                question: "æ®Šå‹ãªå¿ƒãŒã‘ã®æŒã¡ä¸»ã ",
                choices: ["å¥æ°—ãª", "å¯æ†ãª", "å„ªé›…ãª", "åˆ©å£ãª", "å …å®Ÿãª"],
                correct: 0,
                explanation: "å¥æ°—: ã‘ãªã’ãªã€ç«‹æ´¾ãªå¿ƒãŒã‘ã®"
            },
            {
                question: "ã‚ãŒã¾ã¾ã§å¥½ãå‹æ‰‹ã«æŒ¯ã‚‹èˆã†ã“ã¨",
                choices: ["åšé¡”", "å‚²æ…¢", "å°‚æ¨ª", "ç‹¬æ–­", "ä¸éœ"],
                correct: 2,
                explanation: "å°‚æ¨ª: ã‚ãŒã¾ã¾å‹æ‰‹ã«æŒ¯ã‚‹èˆã†ã“ã¨"
            },
            {
                question: "ç´°ã‹ãä¸¹å¿µãªè¨˜éŒ²",
                choices: ["å…‹æ˜ãª", "å‘¨åˆ°ãª", "ç²¾å¯†ãª", "ç¹Šç´°ãª", "è‚è¦ãª"],
                correct: 0,
                explanation: "å…‹æ˜: è©³ã—ãæ˜ã‚‰ã‹ãªã“ã¨"
            },
            {
                question: "ã¤ã¤ã¿ã‹ãã•ãªã„ã•ã¾",
                choices: ["éœ²å‘ˆ", "æš´éœ²", "ã‚ã‘ã™ã‘", "ã‚ã‹æŠœã‘", "ã¤ã¤æŠœã‘"],
                correct: 2,
                explanation: "ã‚ã‘ã™ã‘: åŒ…ã¿éš ã•ãšã€ç‡ç›´ãªã•ã¾"
            },
            {
                question: "ã‚ã‚‹å­¦å•ãƒ»æŠ€è¡“ã«ã¤ã„ã¦åºƒãæ·±ã„çŸ¥è­˜ã¨ç†è§£ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨",
                choices: ["è‹±çŸ¥", "å¥¥ç¾©", "é€ è©£", "å«è“„", "é«˜å°š"],
                correct: 2,
                explanation: "é€ è©£: å­¦å•ãƒ»æŠ€èŠ¸ã«æ·±ãé€šã˜ã¦ã„ã‚‹ã“ã¨"
            },
            {
                question: "ãã†ã™ã‚‹ã‚ˆã‚Šã»ã‹ã«ãªã„",
                choices: ["ç”³ã—åˆ†ãªã„", "ã»ã‹ãªã‚‰ãªã„", "ã•ã—ã•ã‚ã‚Šãªã„", "ã‚ˆã‚“ã©ã“ã‚ãªã„", "æŠœãå·®ã—ãªã‚‰ãªã„"],
                correct: 3,
                explanation: "ã‚ˆã‚“ã©ã“ã‚ãªã„: ã‚„ã‚€ã‚’å¾—ãªã„ã€ä»•æ–¹ãŒãªã„"
            },
            {
                question: "ä»²ãŒæ‚ªãã«ã‚‰ã¿åˆã†ã“ã¨",
                choices: ["æ•µè¦–", "æ•µå¯¾", "åæŠ—", "åç›®", "èƒŒå"],
                correct: 3,
                explanation: "åç›®: ä»²ãŒæ‚ªãã«ã‚‰ã¿åˆã†ã“ã¨"
            },
            {
                question: "ã ã‚“ã ã‚“ã„ã„æ°—ã«ãªã£ã¦äººã‚’è¦‹ä¸‹ã—ãŸãµã‚‹ã¾ã„ã‚’ã™ã‚‹ã“ã¨",
                choices: ["è™šå‹¢", "èª‡ç¤º", "è‡ªè² ", "å¢—é•·", "ä¸éœ"],
                correct: 3,
                explanation: "å¢—é•·: ã ã‚“ã ã‚“èª¿å­ã«ä¹—ã£ã¦æ€ã„ä¸ŠãŒã‚‹ã“ã¨"
            }
        ];

        // ã‚¢ãƒ—ãƒªã®çŠ¶æ…‹
        let selectedQuestionCount = 0;
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let incorrectQuestions = [];
        let userAnswers = [];

        // å•é¡Œæ•°é¸æŠ
        function selectCount(count) {
            selectedQuestionCount = count;
            document.getElementById('custom-count').value = '';
            updateStartButton();
        }

        function selectCustomCount() {
            const customInput = document.getElementById('custom-count');
            const count = parseInt(customInput.value);
            if (count >= 1 && count <= 286) {
                selectedQuestionCount = count;
                updateStartButton();
            } else {
                alert('1ã‹ã‚‰286ã®é–“ã§å…¥åŠ›ã—ã¦ãã ã•ã„');
            }
        }

        function updateStartButton() {
            const startBtn = document.getElementById('start-btn');
            if (selectedQuestionCount > 0) {
                startBtn.disabled = false;
                startBtn.textContent = `${selectedQuestionCount}å•ã§ã‚¹ã‚¿ãƒ¼ãƒˆ`;
            } else {
                startBtn.disabled = true;
                startBtn.textContent = 'ã‚¯ã‚¤ã‚ºã‚’é–‹å§‹ã™ã‚‹';
            }
        }

        // ã‚¯ã‚¤ã‚ºé–‹å§‹
        function startQuiz() {
            if (selectedQuestionCount === 0) return;

            // å•é¡Œã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ
            const shuffled = [...quizData].sort(() => 0.5 - Math.random());
            currentQuestions = shuffled.slice(0, Math.min(selectedQuestionCount, quizData.length));
            
            // çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
            currentQuestionIndex = 0;
            correctAnswers = 0;
            incorrectQuestions = [];
            userAnswers = [];

            // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('home-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';
            document.getElementById('result-screen').style.display = 'none';

            showQuestion();
        }

        // å•é¡Œè¡¨ç¤º
        function showQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            
            // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
            const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // å•é¡Œç•ªå·è¡¨ç¤º
            document.getElementById('question-counter').textContent = 
                `å•é¡Œ ${currentQuestionIndex + 1} / ${currentQuestions.length}`;
            
            // å•é¡Œæ–‡è¡¨ç¤º
            document.getElementById('question-text').textContent = question.question;
            
            // é¸æŠè‚¢è¡¨ç¤º
            const choicesContainer = document.getElementById('choices');
            choicesContainer.innerHTML = '';
            
            question.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = `${String.fromCharCode(65 + index)}. ${choice}`;
                button.onclick = () => selectAnswer(index);
                choicesContainer.appendChild(button);
            });
            
            // çµæœè¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('result-display').className = 'result-display hidden';
            document.getElementById('explanation').className = 'explanation hidden';
            document.getElementById('next-btn').className = 'next-btn hidden';
        }

        // å›ç­”é¸æŠ
        function selectAnswer(selectedIndex) {
            const question = currentQuestions[currentQuestionIndex];
            const choices = document.querySelectorAll('.choice-btn');
            const resultDisplay = document.getElementById('result-display');
            const explanation = document.getElementById('explanation');
            const nextBtn = document.getElementById('next-btn');
            
            // ã™ã¹ã¦ã®é¸æŠè‚¢ã‚’ç„¡åŠ¹åŒ–
            choices.forEach(btn => btn.classList.add('disabled'));
            
            // æ­£è§£ã®é¸æŠè‚¢ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            choices[question.correct].classList.add('correct');
            
            // é¸æŠã•ã‚ŒãŸå›ç­”ã®å‡¦ç†
            if (selectedIndex === question.correct) {
                // æ­£è§£ã®å ´åˆ
                correctAnswers++;
                resultDisplay.textContent = 'âœ… æ­£è§£ï¼';
                resultDisplay.className = 'result-display correct';
            } else {
                // ä¸æ­£è§£ã®å ´åˆ
                choices[selectedIndex].classList.add('incorrect');
                resultDisplay.textContent = 'âŒ ä¸æ­£è§£';
                resultDisplay.className = 'result-display incorrect';
                incorrectQuestions.push({
                    ...question,
                    userAnswer: selectedIndex
                });
            }
            
            // å›ç­”ã‚’è¨˜éŒ²
            userAnswers.push({
                questionIndex: currentQuestionIndex,
                userAnswer: selectedIndex,
                correct: selectedIndex === question.correct
            });
            
            // è§£èª¬è¡¨ç¤º
            explanation.innerHTML = `
                <h3>ğŸ“– è§£èª¬</h3>
                <p><strong>${question.choices[question.correct]}</strong>: ${question.explanation}</p>
            `;
            explanation.className = 'explanation';
            
            // æ¬¡ã¸ãƒœã‚¿ãƒ³è¡¨ç¤º
            if (currentQuestionIndex < currentQuestions.length - 1) {
                nextBtn.textContent = 'æ¬¡ã®å•é¡Œã¸';
            } else {
                nextBtn.textContent = 'çµæœã‚’è¦‹ã‚‹';
            }
            nextBtn.className = 'next-btn';
        }

        // æ¬¡ã®å•é¡Œã¸
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < currentQuestions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        // çµæœè¡¨ç¤º
        function showResults() {
            const scorePercentage = Math.round((correctAnswers / currentQuestions.length) * 100);
            
            // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            
            // ã‚¹ã‚³ã‚¢è¡¨ç¤º
            document.getElementById('score-number').textContent = 
                `${correctAnswers} / ${currentQuestions.length}`;
            document.getElementById('score-percentage').textContent = 
                `æ­£è§£ç‡: ${scorePercentage}%`;
            
            // å¾©ç¿’ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            const retryBtn = document.getElementById('retry-btn');
            if (incorrectQuestions.length > 0) {
                retryBtn.style.display = 'block';
                retryBtn.textContent = `é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’ (${incorrectQuestions.length}å•)`;
            } else {
                retryBtn.style.display = 'none';
            }
        }

        // ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
        function goHome() {
            document.getElementById('home-screen').style.display = 'block';
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'none';
            
            // çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
            selectedQuestionCount = 0;
            updateStartButton();
        }

        // é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’
        function retryIncorrect() {
            if (incorrectQuestions.length === 0) return;
            
            // é–“é•ãˆãŸå•é¡Œã§ã‚¯ã‚¤ã‚ºã‚’å†é–‹
            currentQuestions = [...incorrectQuestions];
            selectedQuestionCount = currentQuestions.length;
            
            // çŠ¶æ…‹ãƒªã‚»ãƒƒãƒˆ
            currentQuestionIndex = 0;
            correctAnswers = 0;
            incorrectQuestions = [];
            userAnswers = [];
            
            // ã‚¯ã‚¤ã‚ºç”»é¢ã«åˆ‡ã‚Šæ›¿ãˆ
            document.getElementById('result-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';
            
            showQuestion();
        }

        // ã‚«ã‚¹ã‚¿ãƒ å…¥åŠ›ã§Enterã‚­ãƒ¼å¯¾å¿œ
        document.getElementById('custom-count').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                selectCustomCount();
            }
        });

        // åˆæœŸåŒ–
        updateStartButton();
